# MPLang Cluster Configuration v2.4
# This file serves as the Single Source of Truth (SSOT) for a sample cluster
# topology.

# ===================================================================
# Physical Layer: Definition of all Physical Nodes
# This is the complete list of all addressable compute nodes in the network.
# ===================================================================
nodes:
  - name: alice_node
    endpoint: "127.0.0.1:9001"
    runtime_info:
      version: "2.0.0"
      platform: "cpu"

  - name: bob_node
    endpoint: "127.0.0.1:9002"
    runtime_info:
      version: "2.0.0"
      platform: "cpu"

  # --- Carol's capabilities are split into two distinct PPs for security ---

  - name: carol_node
    endpoint: "127.0.0.1:9003"
    runtime_info:
      version: "2.0.0"
      # This PP is Carol's standard compute node. It can access local data.
      platform: "cpu"

  - name: carol_tee
    endpoint: "127.0.0.1:9004" # Note: Different port, separate process
    runtime_info:
      version: "2.0.0"
      # This PP is a dedicated TEE service node. It cannot access local data.
      platform: "intel_sgx_2.16"
      # Example per-op kernel override bindings for this TEE node.
      # Keys are logical op names, values are kernel implementation IDs.
      op_bindings:
        tee.quote_gen: mock_tee.quote_gen
        tee.attest: mock_tee.attest

# ===================================================================
# Logical Layer: Definition of all Logical Devices (VPs)
# This is the complete universe of entities addressable by the user-facing API.
# ===================================================================
devices:
  # --- Devices representing single nodes (kind: PPU) ---
  # These devices map 1:1 to physical nodes for plaintext computation
  alice:
    kind: PPU
    members: [alice_node]

  bob:
    kind: PPU
    members: [bob_node]

  carol_local:
    kind: PPU
    members: [carol_node]

  # --- Composite and Special Devices ---
  # An SPU device for 2-party computation between Alice and Bob.
  spu_2pc:
    kind: spu
    members: [alice_node, bob_node]
    config:
      protocol: SEMI2K
      field: FM64

  # An SPU device for 3-party computation.
  # Note that it uses 'carol_node', not 'carol_tee'.
  spu_3pc:
    kind: spu
    members: [alice_node, bob_node, carol_node]
    config:
      protocol: ABY3
      field: FM128

  # The TEE device, which is a VP composed of the dedicated 'carol_tee' PP.
  trusted_executor:
    kind: tee
    members: [carol_tee]
    config:
      # Intel SGX enclave configuration
      enclave_binary: "trusted_executor.signed.so" # Enclave binary filename
      enclave_config: "trusted_executor.xml" # SGX config file
